<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budines Artesanales - Trini & Guada</title>

    <!-- Enlace al archivo CSS externo -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧁 Budines Artesanales 🧁</h1>
            <h1>Trini & Guada</h1>
            <p>Crea tu budín perfecto con ingredientes frescos y naturales</p>
        </div>

        <div class="main-content">
            <div class="form-section">
                <div class="form-group">
                    <h3>👤 Datos del cliente</h3>
                    <div class="input-grid" style="margin-bottom:10px;">
                        <input type="text" id="firstName" placeholder="Nombre" class="input-field" required>
                        <input type="text" id="lastName" placeholder="Apellido" class="input-field" required>
                    </div>
                </div>

                <div class="form-group">
                    <h3>🎂 Elige tu sabor base</h3>
                    <div class="options-grid" id="flavors"></div>
                </div>

                <div class="form-group">
                    <h3>✨ Agregados extras</h3>
                    <div class="options-grid" id="extras"></div>
                </div>

                <div class="form-group">
                    <h3>🌟 Super extras premium</h3>
                    <div class="options-grid" id="superExtras"></div>
                </div>
            </div>

            <div class="preview-section">
                <h3 class="preview-title">Vista previa de tu budín</h3>
                <div class="budin-preview">
                    <div class="budin-base" id="budinBase"><span style="font-size:2.6rem">🧁</span></div>
                    <div class="ingredients-display" id="ingredientsDisplay"></div>
                </div>

                <div class="order-summary">
                    <div id="orderDetails"><p style="text-align:center;color:var(--muted);">Completa tus datos y selecciona los ingredientes para ver el resumen</p></div>
                    <div class="price-display" id="priceDisplay">$0</div>

                    <div class="cvu-container">
                        <div class="cvu-label" style="font-weight:700;color:#2c3e50;margin-bottom:6px;font-size:0.95rem">💳 CVU para transferencia:</div>
                        <div class="cvu-number" id="cvuNumber" onclick="copyCVU()">0000003100065308425641</div>
                        <div class="copy-message" style="font-size:0.82rem;color:var(--muted);margin-top:6px">Haz clic para copiar</div>
                    </div>

                    <button class="order-btn" id="orderBtn" disabled onclick="processOrder()">Realizar Pedido</button>
                </div>
            </div>
        </div>
    </div>

    <div class="cooking-animation" id="cookingAnimation">
        <div class="cooking-content">
            <div class="oven-icon">🔥</div>
            <div class="cooking-text">¡Tu budín se está cocinando!</div>
            <div class="progress-bar" style="width:100%;height:8px;background:#ecf0f1;border-radius:6px;overflow:hidden;margin:12px 0">
                <div class="progress-fill" id="progressFill" style="height:100%;background:linear-gradient(90deg,var(--accent),#2ecc71);width:0%"></div>
            </div>
            <p id="cookingStatus">Preparando ingredientes...</p>
        </div>
    </div>

    <script>
        // Lista de sabores
        const flavors = [
            { id: 'chocolate', name: 'Chocolate', icon: '🍫', color: '#8B4513' },
            { id: 'vainilla', name: 'Vainilla', icon: '🌟', color: '#FFF8DC' },
            { id: 'banana', name: 'Banana', icon: '🍌', color: '#FFE135' },
            { id: 'limon', name: 'Limón', icon: '🍋', color: '#FFF700' },
            { id: 'naranja', name: 'Naranja', icon: '🍊', color: '#FFA500' },
            { id: 'coco', name: 'Coco', icon: '🥥', color: '#F5F5DC' },
            { id: 'mandarina', name: 'Mandarina', icon: '🍊', color: '#FF8C00' },
            { id: 'marmolado', name: 'Marmolado', icon: '🎨', color: 'linear-gradient(45deg, #8B4513, #FFF8DC)' },
            { id: 'carrot', name: 'Zanahoria', icon: '🥕', color: '#FF6347' }
        ];

        const BASE_FLAVOR_PRICE = 4000;

        const extras = [
            { id: 'arandanos', name: 'Arándanos', icon: '🫐', price: 1600 },
            { id: 'chips-chocolate', name: 'Chips de Chocolate', icon: '🍫', price: 1400 },
            { id: 'dulce-leche', name: 'Dulce de Leche', icon: '🍯', price: 670 },
            { id: 'coco-rallado', name: 'Coco', icon: '🥥', price: 1550 },
            { id: 'nueces', name: 'Nueces', icon: '🥜', price: 1000 },
            { id: 'almendras', name: 'Almendras', icon: '🌰', price: 1350 },
            { id: 'mix-semillas', name: 'Mix Semillas', icon: '🌱', price: 980 },
            { id: 'pasas', name: 'Pasas de Uva', icon: '🍇', price: 450 },
            { id: 'frutos-rojos', name: 'Frutos Rojos', icon: '🍓', price: 1800 }
        ];

        const superExtras = [
            { id: 'bano-chocolate', name: 'Baño de Chocolate', icon: '🍫', price: 2750 },
            { id: 'glaseado', name: 'Glaseado', icon: '✨', price: 2750 }
        ];

        let selection = { firstName: '', lastName: '', flavor: null, extras: [], superExtras: [] };

        function initApp() {
            renderFlavors();
            renderExtras();
            renderSuperExtras();
            setupInputListeners();
        }

        function setupInputListeners() {
            document.getElementById('firstName').addEventListener('input', function () {
                selection.firstName = this.value;
                updatePreview();
            });
            document.getElementById('lastName').addEventListener('input', function () {
                selection.lastName = this.value;
                updatePreview();
            });
        }

        function copyCVU() {
            const cvuText = '0000003100065308425641';
            navigator.clipboard.writeText(cvuText).then(() => {
                const cvuElement = document.getElementById('cvuNumber');
                const originalBg = cvuElement.style.background;
                cvuElement.style.background = '#2ecc71';
                cvuElement.style.color = 'white';
                setTimeout(() => {
                    cvuElement.style.background = originalBg;
                    cvuElement.style.color = '#2980b9';
                }, 800);
                const copyMessage = document.querySelector('.copy-message');
                const originalText = copyMessage.textContent;
                copyMessage.textContent = '¡Copiado al portapapeles! ✅';
                copyMessage.style.color = '#2ecc71';
                setTimeout(() => {
                    copyMessage.textContent = originalText;
                    copyMessage.style.color = 'var(--muted)';
                }, 2000);
            }).catch(() => {
                alert('CVU: 0000003100065308425641');
            });
        }

        function renderFlavors() {
            document.getElementById('flavors').innerHTML = flavors.map(flavor =>
                `<div class="option-card" onclick="selectFlavor('${flavor.id}')" id="flavor-${flavor.id}">
                    <span class="option-icon">${flavor.icon}</span>
                    <div class="option-name">${flavor.name}</div>
                </div>`
            ).join('');
        }

        function renderExtras() {
            document.getElementById('extras').innerHTML = extras.map(extra =>
                `<div class="option-card" onclick="toggleExtra('${extra.id}')" id="extra-${extra.id}">
                    <span class="option-icon">${extra.icon}</span>
                    <div class="option-name">${extra.name}</div>
                    <div style="font-size:0.8rem;color:var(--muted);">+$${extra.price}</div>
                </div>`
            ).join('');
        }

        function renderSuperExtras() {
            document.getElementById('superExtras').innerHTML = superExtras.map(se =>
                `<div class="option-card" onclick="toggleSuperExtra('${se.id}')" id="superExtra-${se.id}">
                    <span class="option-icon">${se.icon}</span>
                    <div class="option-name">${se.name}</div>
                    <div style="font-size:0.8rem;color:var(--muted);">+$${se.price}</div>
                </div>`
            ).join('');
        }

        function selectFlavor(flavorId) {
            document.querySelectorAll('#flavors .option-card').forEach(card => card.classList.remove('selected'));
            document.getElementById(`flavor-${flavorId}`).classList.add('selected');
            selection.flavor = flavorId;
            updatePreview();
        }

        function toggleExtra(extraId) {
            const card = document.getElementById(`extra-${extraId}`);
            const idx = selection.extras.indexOf(extraId);
            if (idx > -1) {
                selection.extras.splice(idx, 1);
                card.classList.remove('selected');
            } else {
                selection.extras.push(extraId);
                card.classList.add('selected');
            }
            updatePreview();
        }

        function toggleSuperExtra(superExtraId) {
            const card = document.getElementById(`superExtra-${superExtraId}`);
            const idx = selection.superExtras.indexOf(superExtraId);
            if (idx > -1) {
                selection.superExtras.splice(idx, 1);
                card.classList.remove('selected');
            } else {
                selection.superExtras.push(superExtraId);
                card.classList.add('selected');
            }
            updatePreview();
        }

        function updatePreview() {
            const budinBase = document.getElementById('budinBase');
            const ingredientsDisplay = document.getElementById('ingredientsDisplay');
            const orderDetails = document.getElementById('orderDetails');
            const priceDisplay = document.getElementById('priceDisplay');
            const orderBtn = document.getElementById('orderBtn');

            if (selection.flavor) {
                const flavor = flavors.find(f => f.id === selection.flavor);
                if (flavor.color.includes('gradient')) budinBase.style.background = flavor.color;
                else budinBase.style.backgroundColor = flavor.color;
                budinBase.innerHTML = `<span style="font-size:2.6rem">${flavor.icon}</span>`;
            } else {
                budinBase.style.background = '';
                budinBase.innerHTML = '<span style="font-size:2.6rem">🧁</span>';
            }

            let ingredientsHTML = '';
            selection.extras.forEach(extraId => {
                const extra = extras.find(e => e.id === extraId);
                ingredientsHTML += `<div class="ingredient-item"><span style="margin-right:6px;color:#27ae60;font-weight:700">+</span><span>${extra.icon} ${extra.name}</span></div>`;
            });
            selection.superExtras.forEach(seId => {
                const se = superExtras.find(s => s.id === seId);
                ingredientsHTML += `<div class="ingredient-item"><span style="margin-right:6px;color:#27ae60;font-weight:700">+</span><span>${se.icon} ${se.name}</span></div>`;
            });
            ingredientsDisplay.innerHTML = ingredientsHTML;

            let totalPrice = 0;
            if (selection.flavor) totalPrice += BASE_FLAVOR_PRICE;
            selection.extras.forEach(extraId => totalPrice += extras.find(e => e.id === extraId).price);
            selection.superExtras.forEach(seId => totalPrice += superExtras.find(s => s.id === seId).price);

            if (selection.firstName && selection.lastName && selection.flavor) {
                const flavor = flavors.find(f => f.id === selection.flavor);
                let detailsHTML = `<p><strong>Nombre:</strong> ${selection.firstName} ${selection.lastName}</p>
                                   <p><strong>Sabor:</strong> ${flavor.name}</p>`;
                if (selection.extras.length > 0)
                    detailsHTML += `<p><strong>Extras:</strong> ${selection.extras.map(id => extras.find(e => e.id === id).name).join(', ')}</p>`;
                if (selection.superExtras.length > 0)
                    detailsHTML += `<p><strong>Premium:</strong> ${selection.superExtras.map(id => superExtras.find(se => se.id === id).name).join(', ')}</p>`;
                orderDetails.innerHTML = detailsHTML;
                orderBtn.disabled = false;
            } else {
                let missingData = [];
                if (!selection.firstName || !selection.lastName) missingData.push('Nombre completo');
                if (!selection.flavor) missingData.push('sabor');
                orderDetails.innerHTML = `<p style="text-align:center;color:var(--muted)">Falta: ${missingData.join(', ')}</p>`;
                orderBtn.disabled = true;
            }

            priceDisplay.textContent = `$${totalPrice}`;
        }

        function processOrder() {
            const cookingAnimation = document.getElementById('cookingAnimation');
            const progressFill = document.getElementById('progressFill');
            const cookingStatus = document.getElementById('cookingStatus');
            const steps = [
                { text: 'Preparando ingredientes...', icon: '🥚', duration: 1000 },
                { text: 'Mezclando la masa...', icon: '🥣', duration: 1500 },
                { text: 'Agregando los extras...', icon: '✨', duration: 1000 },
                { text: 'Horneando tu budín...', icon: '🔥', duration: 2000 },
                { text: '¡Budín listo para retirar!', icon: '🍰', duration: 1000 }
            ];

            cookingAnimation.style.display = 'flex';
            let currentStep = 0;
            let progress = 0;

            function nextStep() {
                if (currentStep < steps.length) {
                    cookingStatus.textContent = steps[currentStep].text;
                    const ovenIcon = document.querySelector('.oven-icon');
                    ovenIcon.textContent = steps[currentStep].icon;
                    ovenIcon.className = 'oven-icon';
                    const stepProgress = 100 / steps.length;
                    const targetProgress = (currentStep + 1) * stepProgress;
                    const progressInterval = setInterval(() => {
                        progress += 2;
                        progressFill.style.width = Math.min(progress, targetProgress) + '%';
                        if (progress >= targetProgress) {
                            clearInterval(progressInterval);
                            currentStep++;
                            setTimeout(() => {
                                if (currentStep < steps.length) nextStep();
                                else {
                                    setTimeout(() => {
                                        cookingAnimation.style.display = 'none';
                                        const flavor = flavors.find(f => f.id === selection.flavor);
                                        let message = `*NUEVO PEDIDO - BUDINES ARTESANALES*\n\n`;
                                        message += `*CLIENTE:* ${selection.firstName} ${selection.lastName}\n\n`;
                                        message += `*RESUMEN DEL PEDIDO:*\n`;
                                        message += `• *Sabor:* ${flavor.name}\n`;
                                        if (selection.extras.length > 0) {
                                            message += `\n*EXTRAS:*\n`;
                                            selection.extras.forEach(extraId => {
                                                const extra = extras.find(e => e.id === extraId);
                                                message += `• ${extra.name}\n`;
                                            });
                                        }
                                        if (selection.superExtras.length > 0) {
                                            message += `\n*PREMIUM:*\n`;
                                            selection.superExtras.forEach(seId => {
                                                const se = superExtras.find(s => s.id === seId);
                                                message += `• ${se.name} - $${se.price}\n`;
                                            });
                                        }
                                        let totalPrice = BASE_FLAVOR_PRICE;
                                        selection.extras.forEach(extraId => totalPrice += extras.find(e => e.id === extraId).price);
                                        selection.superExtras.forEach(seId => totalPrice += superExtras.find(s => s.id === seId).price);
                                        message += `\n*TOTAL: $${totalPrice}*\n\n`;
                                        message += `Fecha: ${new Date().toLocaleDateString('es-AR')}\n`;
                                        message += `Hora: ${new Date().toLocaleTimeString('es-AR', { hour: '2-digit', minute: '2-digit' })}`;
                                        const encodedMessage = encodeURIComponent(message);
                                        location.href = `https://wa.me/5492613618633?text=${encodedMessage}`;
                                        resetForm();
                                    }, 1000);
                                }
                            }, steps[currentStep - 1].duration);
                        }
                    }, 50);
                }
            }

            nextStep();
        }

        function resetForm() {
            selection = { firstName: '', lastName: '', flavor: null, extras: [], superExtras: [] };
            document.getElementById('firstName').value = '';
            document.getElementById('lastName').value = '';
            document.querySelectorAll('.option-card').forEach(c => c.classList.remove('selected'));
            document.getElementById('budinBase').style.background = '';
            document.getElementById('budinBase').innerHTML = '<span style="font-size:2.6rem">🧁</span>';
            updatePreview();
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
